# ğŸŒ Hedge Farm - Ğ’ĞµĞ±-Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ

## ğŸ“± Ğ§Ñ‚Ğ¾ Ğ²Ñ‹ ÑƒĞ²Ğ¸Ğ´Ğ¸Ñ‚Ğµ Ğ² Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ğµ

### ğŸ  Ğ“Ğ»Ğ°Ğ²Ğ½Ğ°Ñ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ğ°: `http://localhost:8000/`

```json
{
    "service": "HedgeFarm Pricer",
    "version": "0.1.0", 
    "description": "API Ğ´Ğ»Ñ Ñ€Ğ°ÑÑ‡ĞµÑ‚Ğ° Ğ¼Ğ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ğ³Ğ°Ñ€Ğ°Ğ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ¹ Ñ†ĞµĞ½Ñ‹",
    "endpoints": {
        "price": "/price - ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ Ñ€Ğ°ÑÑ‡ĞµÑ‚ Ñ†ĞµĞ½Ñ‹",
        "health": "/health - ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ ÑĞµÑ€Ğ²Ğ¸ÑĞ°",
        "detailed": "/price/detailed - Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·"
    }
}
```

### ğŸ“š Swagger UI Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ: `http://localhost:8000/docs`

**ĞšÑ€Ğ°ÑĞ¸Ğ²Ñ‹Ğ¹ Ğ¸Ğ½Ñ‚ĞµÑ€Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¹ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ Ñ:**

```
ğŸ¯ HedgeFarm Pricer API
API Ğ´Ğ»Ñ Ñ€Ğ°ÑÑ‡ĞµÑ‚Ğ° Ğ¼Ğ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ğ³Ğ°Ñ€Ğ°Ğ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ¹ Ñ†ĞµĞ½Ñ‹ Ğ¿Ñ€Ğ¸ Ñ…ĞµĞ´Ğ¶Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¸ ÑĞµĞ»ÑŒÑ…Ğ¾Ğ·Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ²

ğŸ“‹ Ğ­Ğ½Ğ´Ğ¿Ğ¾Ğ¸Ğ½Ñ‚Ñ‹:

1. GET / - ĞšĞ¾Ñ€Ğ½ĞµĞ²Ğ¾Ğ¹ ÑĞ½Ğ´Ğ¿Ğ¾Ğ¸Ğ½Ñ‚  
   â””â”€ Ğ˜Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ ÑĞµÑ€Ğ²Ğ¸ÑĞµ

2. GET /health - ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ·Ğ´Ğ¾Ñ€Ğ¾Ğ²ÑŒÑ ÑĞµÑ€Ğ²Ğ¸ÑĞ°
   â””â”€ Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ Ğº MOEX

3. GET /price - Ğ Ğ°ÑÑ‡ĞµÑ‚ Ğ¼Ğ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ğ³Ğ°Ñ€Ğ°Ğ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ¹ Ñ†ĞµĞ½Ñ‹
   ğŸ“‹ ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹:
   â”œâ”€ culture: wheat | corn | barley
   â”œâ”€ volume: Ğ¾Ğ±ÑŠĞµĞ¼ Ğ² Ñ‚Ğ¾Ğ½Ğ½Ğ°Ñ…  
   â””â”€ term_months: ÑÑ€Ğ¾Ğº Ğ² Ğ¼ĞµÑÑÑ†Ğ°Ñ…
   
   ğŸ“Š ĞÑ‚Ğ²ĞµÑ‚:
   â”œâ”€ floor_futures_rubkg: Ñ†ĞµĞ½Ğ° Ñ„ÑŒÑÑ‡ĞµÑ€ÑĞ¾Ğ²
   â”œâ”€ floor_put_rubkg: Ñ†ĞµĞ½Ğ° PUT Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ¾Ğ²  
   â”œâ”€ floor_forward_rubkg: Ñ†ĞµĞ½Ğ° Ñ„Ğ¾Ñ€Ğ²Ğ°Ñ€Ğ´Ğ¾Ğ²
   â””â”€ recommended: Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ñ

4. GET /price/detailed - Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·
   ğŸ“Š Ğ Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ½Ğ°Ñ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¼Ñƒ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ñƒ

5. POST /price - Ğ Ğ°ÑÑ‡ĞµÑ‚ Ñ JSON Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ°Ğ¼Ğ¸
   ğŸ“ Ğ¢ĞµĞ»Ğ¾ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°: PriceRequest
```

### ğŸ¯ ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ° API

**Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ Ñ€Ğ°ÑÑ‡ĞµÑ‚ Ñ†ĞµĞ½Ñ‹:**
```json
{
    "culture": "wheat",
    "volume_t": 1000,
    "term_m": 6,
    "floor_futures_rubkg": 14.64,
    "floor_put_rubkg": 14.69,
    "floor_forward_rubkg": 14.46,
    "recommended": "put",
    "calculated_at": "2025-07-11T15:02:08.778727"
}
```

**Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·:**
```json
{
    "futures": {
        "mgp_rub_kg": 14.58,
        "margin_required": 3300000.0,
        "leverage": 10.0,
        "hedging_efficiency": 0.88
    },
    "put_option": {
        "mgp_rub_kg": 14.69,
        "strike": 16500.0,
        "premium": 50.0,
        "delta": -0.24,
        "ladder_strikes": [[15675.0, 0.25], [16005.0, 0.25]]
    },
    "forward": {
        "mgp_rub_kg": 14.46,
        "discount_applied": 0.015,
        "no_margin_required": true
    },
    "market_context": {
        "futures_price": 16500.0,
        "volatility": 0.22,
        "usd_rate": 95.0
    }
}
```

### ğŸ”§ Health Check: `http://localhost:8000/health`

```json
{
    "status": "healthy",
    "moex_connection": "ok", 
    "test_wheat_price": 16500.0,
    "timestamp": "2024-01-01T00:00:00Z"
}
```

## ğŸ¨ Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ

### Swagger UI Ğ²Ñ‹Ğ³Ğ»ÑĞ´Ğ¸Ñ‚ ĞºĞ°Ğº:

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ğŸ¯ HedgeFarm Pricer API                                   â•‘
â•‘  API Ğ´Ğ»Ñ Ñ€Ğ°ÑÑ‡ĞµÑ‚Ğ° Ğ¼Ğ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ğ³Ğ°Ñ€Ğ°Ğ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ¹ Ñ†ĞµĞ½Ñ‹          â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                            â•‘
â•‘  ğŸ“‚ default                                                â•‘
â•‘                                                            â•‘
â•‘  â–¼ GET /        ĞšĞ¾Ñ€Ğ½ĞµĞ²Ğ¾Ğ¹ ÑĞ½Ğ´Ğ¿Ğ¾Ğ¸Ğ½Ñ‚                         â•‘
â•‘     â””â”€ [Try it out] [Execute]                             â•‘
â•‘                                                            â•‘
â•‘  â–¼ GET /health  ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ·Ğ´Ğ¾Ñ€Ğ¾Ğ²ÑŒÑ ÑĞµÑ€Ğ²Ğ¸ÑĞ°                â•‘
â•‘     â””â”€ [Try it out] [Execute]                             â•‘
â•‘                                                            â•‘
â•‘  â–¼ GET /price   Ğ Ğ°ÑÑ‡ĞµÑ‚ Ğ¼Ğ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ğ³Ğ°Ñ€Ğ°Ğ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ¹ Ñ†ĞµĞ½Ñ‹   â•‘
â•‘     ğŸ“‹ Parameters:                                         â•‘
â•‘     â”œâ”€ culture*    [wheat â–¼]                              â•‘
â•‘     â”œâ”€ volume*     [1000     ]                            â•‘
â•‘     â””â”€ term_months* [6       ]                            â•‘
â•‘     â””â”€ [Try it out] [Execute]                             â•‘
â•‘                                                            â•‘
â•‘  â–¼ GET /price/detailed  Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·                 â•‘
â•‘     â””â”€ [Try it out] [Execute]                             â•‘
â•‘                                                            â•‘
â•‘  â–¼ POST /price  Ğ Ğ°ÑÑ‡ĞµÑ‚ Ñ JSON Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ°Ğ¼Ğ¸                â•‘
â•‘     ğŸ“ Request body:                                       â•‘
â•‘     {                                                      â•‘
â•‘       "culture": "wheat",                                  â•‘
â•‘       "volume": 1000,                                      â•‘
â•‘       "term_months": 6                                     â•‘
â•‘     }                                                      â•‘
â•‘     â””â”€ [Try it out] [Execute]                             â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### ğŸŒŸ Ğ˜Ğ½Ñ‚ĞµÑ€Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğµ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸:

1. **"Try it out"** - Ğ¿Ğ¾Ğ·Ğ²Ğ¾Ğ»ÑĞµÑ‚ Ñ€ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹
2. **"Execute"** - Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ÑĞµÑ‚ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ Ğ¿Ñ€ÑĞ¼Ğ¾ Ğ² Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ğµ  
3. **Response body** - Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚ Ğ² JSON
4. **Response headers** - Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ HTTP Ğ·Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²ĞºĞ¸
5. **Curl command** - Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµÑ‚ Ğ³Ğ¾Ñ‚Ğ¾Ğ²ÑƒÑ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñƒ curl

### ğŸ¯ ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹ curl ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´:

```bash
# Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ Ñ€Ğ°ÑÑ‡ĞµÑ‚
curl -X GET "http://localhost:8000/price?culture=wheat&volume=1000&term_months=6"

# Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·  
curl -X GET "http://localhost:8000/price/detailed?culture=wheat&volume=2000&term_months=9"

# POST Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ
curl -X POST "http://localhost:8000/price" \
     -H "Content-Type: application/json" \
     -d '{"culture":"wheat","volume":1000,"term_months":6}'

# ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ·Ğ´Ğ¾Ñ€Ğ¾Ğ²ÑŒÑ
curl -X GET "http://localhost:8000/health"
```

## ğŸš€ Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€Ğ°

```bash
# 1. ĞĞºÑ‚Ğ¸Ğ²Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ğµ
source venv/bin/activate

# 2. Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ ÑĞµÑ€Ğ²ĞµÑ€
uvicorn hedgefarm.service:app --reload --host 0.0.0.0 --port 8000

# 3. ĞÑ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Ğ² Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ğµ:
# http://localhost:8000/docs - Swagger UI
# http://localhost:8000/ - JSON API info  
# http://localhost:8000/health - Health check
```

---

**ğŸ’¡ Tip:** Swagger UI Ğ¿Ğ¾Ğ»Ğ½Ğ¾ÑÑ‚ÑŒÑ Ğ¸Ğ½Ñ‚ĞµÑ€Ğ°ĞºÑ‚Ğ¸Ğ²ĞµĞ½ - Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ²ÑĞµ ÑĞ½Ğ´Ğ¿Ğ¾Ğ¸Ğ½Ñ‚Ñ‹ Ğ¿Ñ€ÑĞ¼Ğ¾ Ğ² Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ğµ Ğ±ĞµĞ· Ğ½ĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ¿Ğ¸ÑĞ°Ñ‚ÑŒ ĞºĞ¾Ğ´ Ğ¸Ğ»Ğ¸ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ curl!