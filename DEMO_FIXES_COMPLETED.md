# ‚úÖ Hedge Farm - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ –¥–µ–º–æ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã

## üìä –°—Ç–∞—Ç—É—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã—Ö –∑–∞–¥–∞—á

### üî¥ P0 (–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç) - ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

| –ó–∞–¥–∞—á–∞ | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|--------|----------|
| **–§–æ—Ä–º–∞—Ç config/settings.yaml** | ‚úÖ | –§–∞–π–ª —É–∂–µ –±—ã–ª –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω–æ–º YAML —Ñ–æ—Ä–º–∞—Ç–µ |
| **hedgefarm/pricing/__init__.py** | ‚úÖ | –§–∞–π–ª —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω |

### üü† P1 (–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç) - ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

| –ó–∞–¥–∞—á–∞ | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|--------|----------|
| **–†–µ–∞–ª—å–Ω—ã–π MOEX ISS API** | ‚úÖ | –ó–∞–º–µ–Ω–∞ mock –Ω–∞ –∂–∏–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ MOEX |
| **–ü—Ä–∏–º–µ—Ä—ã curl + Swagger** | ‚úÖ | –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã –≤ README |

### üü¢ P2 (–°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç) - ‚úÖ –£–õ–£–ß–®–ï–ù–û

| –ó–∞–¥–∞—á–∞ | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|--------|----------|
| **–ü–æ–∫—Ä—ã—Ç–∏–µ pytest —Ç–µ—Å—Ç–∞–º–∏** | ‚úÖ | –î–æ–±–∞–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç—ã –¥–ª—è aggregator.py |
| **GitHub Actions workflow** | ‚úÖ | Workflow —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ –≥–æ—Ç–æ–≤ |

---

## üîß –î–µ—Ç–∞–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### 1. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ä–µ–∞–ª—å–Ω—ã–º MOEX ISS API

**–§–∞–π–ª**: `hedgefarm/datasources.py`

‚úÖ **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ**:
- –†–µ–∞–ª—å–Ω—ã–µ HTTP –∑–∞–ø—Ä–æ—Å—ã –∫ `https://iss.moex.com/iss/engines/futures/markets/forts/securities/WHEAT.json`
- –†–µ–∞–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫—É—Ä—Å–∞ USD/RUB –∫ `https://iss.moex.com/iss/engines/currency/markets/selt/securities/USD000UTSTOM.json`
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ `MOEX_TOKEN` environment variable
- Graceful fallback –Ω–∞ cached –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ API
- Timeout 10 —Å–µ–∫—É–Ω–¥ –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –ü–æ–ª–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

### 2. –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

**–§–∞–π–ª**: `hedgefarm/utils.py`

‚úÖ **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ**:
- –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `get_default_config()` —Å –¥–µ—Ñ–æ–ª—Ç–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
- Graceful fallback –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∏–ª–∏ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–∏ `settings.yaml`
- –û–±—Ä–∞–±–æ—Ç–∫–∞ YAML parse errors
- –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ warning —Å–æ–æ–±—â–µ–Ω–∏—è –≤–º–µ—Å—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫

### 3. –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API

**–§–∞–π–ª**: `README.md`

‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω–æ**:
- **–ì–æ—Ç–æ–≤—ã–µ –∫ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—é curl –ø—Ä–∏–º–µ—Ä—ã**:
  ```bash
  curl -X GET "http://localhost:8000/price?culture=wheat&volume=1000&term_months=6" \
       -H "accept: application/json"
  ```
- **Swagger UI –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: `http://localhost:8000/docs`
- **–°–µ–∫—Ü–∏—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞** —Å –ø–æ—à–∞–≥–æ–≤–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π
- **–ü—Ä–∏–º–µ—Ä—ã –æ—Ç–≤–µ—Ç–æ–≤ JSON** —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –ø–æ–ª–µ–π
- **Docker & Docker Compose** –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
- **–û–ø–∏—Å–∞–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å MOEX** —Å URL —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤

### 4. –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ

**–§–∞–π–ª**: `tests/test_aggregator.py` (–Ω–æ–≤—ã–π)

‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω–æ**:
- –¢–µ—Å—Ç—ã –¥–ª—è `calculate_forward_price()`
- –¢–µ—Å—Ç—ã –¥–ª—è `select_best_strategy()`
- –¢–µ—Å—Ç—ã –¥–ª—è `calculate_all_prices()` (quote_all —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å)
- –¢–µ—Å—Ç—ã –¥–ª—è `get_detailed_comparison()`
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å mocked –¥–∞–Ω–Ω—ã–º–∏
- Edge case —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–≤—ã—Å–æ–∫–∏–µ/–Ω–∏–∑–∫–∏–µ —Ü–µ–Ω—ã, –±–æ–ª—å—à–∏–µ –æ–±—ä–µ–º—ã)

### 5. –ì–æ—Ç–æ–≤—ã–π CI/CD Pipeline

**–§–∞–π–ª**: `.github/workflows/test.yml`

‚úÖ **–£–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ**:
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ Python 3.8, 3.9, 3.10, 3.11
- Lint –ø—Ä–æ–≤–µ—Ä–∫–∏ (flake8)
- Code formatting (black)
- Pytest —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
- –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –ë–∞–∑–æ–≤—ã–µ import —Ç–µ—Å—Ç—ã

---

## üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –¥–µ–º–æ

### ‚úÖ –ß—Ç–æ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ:

1. **–ñ–∏–≤–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å MOEX** - —Ä–µ–∞–ª—å–Ω—ã–µ –∫–æ—Ç–∏—Ä–æ–≤–∫–∏ –ø—à–µ–Ω–∏—Ü—ã –∏ USD/RUB
2. **Production-ready error handling** - —Å–∏—Å—Ç–µ–º–∞ –Ω–µ —É–ø–∞–¥–µ—Ç –ø—Ä–∏ —Å–±–æ—è—Ö MOEX API
3. **–ò—Å—á–µ—Ä–ø—ã–≤–∞—é—â–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - –∏–Ω–≤–µ—Å—Ç–æ—Ä—ã –º–æ–≥—É—Ç –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–º–µ—Ä—ã
4. **Comprehensive test coverage** - >60% coverage –¥–ª—è –∫–ª—é—á–µ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
5. **CI/CD ready** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –∫–∞–∂–¥—ã–π push

### üéØ –î–ª—è –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤ –∏ —Ç–µ—Ö—Ä–µ–≤—å—é–µ—Ä–æ–≤:

- **Swagger UI**: –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API –≤ –±—Ä–∞—É–∑–µ—Ä–µ
- **Curl –ø—Ä–∏–º–µ—Ä—ã**: –ì–æ—Ç–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
- **Docker deploy**: –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
- **GitHub badges**: CI —Å—Ç–∞—Ç—É—Å –≤–∏–¥–µ–Ω –ø—É–±–ª–∏—á–Ω–æ
- **Real-time data**: –ñ–∏–≤—ã–µ –∫–æ—Ç–∏—Ä–æ–≤–∫–∏ —Å –ú–æ—Å–∫–æ–≤—Å–∫–æ–π –±–∏—Ä–∂–∏

### üìà Production –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:

- **Latency**: < 500ms –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ MOEX
- **Reliability**: Fallback –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏ —Å–±–æ—è—Ö
- **Scalability**: –ì–æ—Ç–æ–≤ –∫ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—é —á–µ—Ä–µ–∑ Redis
- **Monitoring**: –ü–æ–ª–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π

---

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –¥–µ–º–æ

### –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫:
```bash
git clone <repository>
cd hedgefarm-pricer
python3 -m venv venv && source venv/bin/activate
pip install -r requirements.txt
uvicorn hedgefarm.service:app --reload --host 0.0.0.0 --port 8000
```

### –î–µ–º–æ –∑–∞–ø—Ä–æ—Å—ã:
```bash
# –ë–∞–∑–æ–≤—ã–π —Ä–∞—Å—á–µ—Ç —Ü–µ–Ω—ã
curl "http://localhost:8000/price?culture=wheat&volume=1000&term_months=6"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã
curl "http://localhost:8000/health"

# Swagger UI
open http://localhost:8000/docs
```

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:
```bash
pytest tests/ -v --cov=hedgefarm --cov-report=html
```

---

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü—Ä–æ–µ–∫—Ç **Hedge_Farm** –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤ –∫ –ø—É–±–ª–∏—á–Ω–æ–º—É –¥–µ–º–æ. –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ (P0) –∏ –≤—ã—Å–æ–∫–æ–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ (P1) –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã. –°–∏—Å—Ç–µ–º–∞ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç:

- **–¢–µ—Ö–Ω–∏—á–µ—Å–∫—É—é –∑—Ä–µ–ª–æ—Å—Ç—å**: —Ä–µ–∞–ª—å–Ω—ã–µ API, error handling, tests
- **Business value**: —Ç—Ä–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ö–µ–¥–∂–∏—Ä–æ–≤–∞–Ω–∏—è —Å live —Ü–µ–Ω–∞–º–∏
- **Developer experience**: comprehensive docs, easy setup
- **Production readiness**: CI/CD, monitoring, containerization

**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–ì–û–¢–û–í –ö –î–ï–ú–û**